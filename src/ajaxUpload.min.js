/**
 * Uploads a text file containing the vector data and a
 *
 * @returns {boolean} always false to avoid redirect
 */
function setAmount(amountParam){amount=amountParam,donation=50===amountParam||100===amountParam}function submitPayment(token,args){var data=generateUploadArray();return data!==!1||donation?(donation?($("#orderFormInfo").hide(),$("#statusP").text(""),$("#statusDiv").css("background-color","transparent"),$("#statusDiv").css("border","none"),$("#downloadFormInfo").text("Validating credit card..."),$("#downloadFormInfo").css("color","#90CAF9"),$("#downloadFormInfo").show(400)):($("#orderFormInfo").text("Validating credit card..."),$("#orderFormInfo").css("color","#90CAF9"),$("#orderFormInfo").show(400),$("#statusP").text("Uploading..."),$("#statusDiv").css("background-color","#90CAF9"),$("#statusDiv").css("border","1px solid #E3E3E3"),$("#laserModal").foundation("reveal","close")),$.ajax({url:"charge.php",type:"post",data:{tokenid:token.id,email:token.email,amount:amount},success:function(response){"success"==response?donation?($("#downloadFormInfo").hide(400),$("#statusP").text("Thank you for the support!"),$("#statusDiv").css("background-color","#C5E1A5"),$("#statusDiv").css("border","1px solid #E3E3E3"),$("#laserModal").foundation("reveal","close"),download()):($("#orderFormInfo").text("Paid successfully"),$("#orderFormInfo").css("color","#8BC34A"),$("#orderFormInfo").show(400),uploadData(data)):donation?($("#downloadFormInfo").text(response),$("#downloadFormInfo").css("color","#ff0000"),$("#downloadFormInfo").show(400)):($("#orderFormInfo").text(response),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400))},error:function(error){donation?($("#downloadFormInfo").text("Error sending data to stripe"),$("#downloadFormInfo").css("color","#ff0000"),$("#downloadFormInfo").show(400)):($("#orderFormInfo").text("Error sending data to stripe"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400))}}),!1):!1}function validateGiftCode(giftCode){var data=generateUploadArray();return data===!1?!1:""===giftCode?($("#orderFormInfo").text("Please enter a gift code"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1):($("#orderFormInfo").text("Validating gift card..."),$("#orderFormInfo").css("color","#90CAF9"),$("#orderFormInfo").show(400),$.ajax({url:"giftCodeCheck.php",type:"post",data:{code:giftCode},success:function(response){"success"==response?($("#orderFormInfo").text("Gift card is correct"),$("#orderFormInfo").css("color","#8BC34A"),$("#orderFormInfo").show(400),$("#statusP").text("Uploading..."),$("#statusDiv").css("background-color","#90CAF9"),$("#statusDiv").css("border","1px solid #E3E3E3"),$("#laserModal").foundation("reveal","close"),$("#orderFormInfo").hide(400),uploadData(data)):($("#orderFormInfo").text(response),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400))},error:function(error){$("#orderFormInfo").text("Error validating gift card"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400)}}),!1)}function generateUploadArray(){var firstName=document.getElementById("laserFormFirstNameInput").value,lastName=document.getElementById("laserFormLastNameInput").value,address=document.getElementById("laserFormAddressInput").value,city=document.getElementById("laserFormCityInput").value,zipCode=document.getElementById("laserFormZipCodeInput").value,state=document.getElementById("laserFormStateInput").value,country=document.getElementById("laserFormCountryInput").value,eMail=document.getElementById("laserFormEmailInput").value;switch(""){case firstName:return $("#orderFormInfo").text("Please enter your first name"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;case lastName:return $("#orderFormInfo").text("Please enter your last name"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;case address:return $("#orderFormInfo").text("Please enter your address"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;case city:return $("#orderFormInfo").text("Please enter your city"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;case zipCode:return $("#orderFormInfo").text("Please enter your zipCode"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;case state:return $("#orderFormInfo").text("Please enter your state"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;case country:return $("#orderFormInfo").text("Please enter your country"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;case eMail:return $("#orderFormInfo").text("Please enter your e-mail"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;default:$("#orderFormInfo").hide(400)}if(!validateEmail(eMail))return $("#orderFormInfo").text("Please enter a correct e-mail"),$("#orderFormInfo").css("color","#ff0000"),$("#orderFormInfo").show(400),!1;var data={};return data.vectorData=getVectorsXML(),data.firstName=firstName,data.lastName=lastName,data.address=address,data.city=city,data.zipCode=zipCode,data.state=state,data.country=country,data["e-mail"]=eMail,data}function download(){var fileName=document.getElementById("downloadFileNameTxt").value;""===fileName&&(fileName="picture");var currentImage=getCurrentImage();if(null!=currentImage){var canvasTemp=getCanvasTemp(),img=getCurrentImage();canvasTemp.width=img.width,canvasTemp.height=img.height;var ctx=canvasTemp.getContext("2d");ctx.drawImage(img,0,0);var downloadTag=document.getElementById("downloadModalButtonLink");downloadTag.download=fileName+".png",downloadTag.href=canvasTemp.toDataURL("image/png"),downloadTag.click(),$("#downloadModal").foundation("reveal","close")}}var amount,donation,uploadData=function(data){return isVectorized()?($.ajax({url:"vectorUpload.php",type:"POST",data:data,success:function(response){"success"==response?($("#statusP").text("Order placed successfully"),$("#statusDiv").css("background-color","#C5E1A5"),$("#statusDiv").css("border","1px solid #E3E3E3")):($("#statusP").text(response),$("#statusDiv").css("background-color","#EF9A9A"),$("#statusDiv").css("border","1px solid #E3E3E3"))},error:function(error){$("#statusP").text("An error occurred during the upload"),$("#statusDiv").css("background-color","#EF9A9A"),$("#statusDiv").css("border","1px solid #E3E3E3")}}),!1):!1},validateEmail=function(email){var re=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i;return re.test(email)};